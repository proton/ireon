Руководство по компиляции и сборке проекта
==========================================


Содержание
----------
  1. Требования
  2. Компиляция программ
  3. Компиляция документации
  4. Где получить помощь



1. Требования
-------------
  Для сборки проекта вам потребуется:
   * компилятор Microsoft Visual C++ версии 8.0 (2005)

  Опционально, для рендеринга документации:
   * Python версии не ниже 2.3
     http://www.python.org/
   * Java 2 Platform, Standard Edition (J2SE) версии не ниже 1.4
     http://java.sun.com/j2se/corejava/index.jsp
   * scons версии 0.96.1 или выше
     http://www.scons.org

  Убедитесь, что java и python прописаны в путях доступа (переменной
  окружения PATH). Это можно сделать в
      Панель управления -> Система -> Дополнительно ->
      Переменные среды -> Системные переменные
  Там в списке выбрать Path, нажать Изменить и добавить через
  точку с запятой пути, куда были установлены python и java.


2. Компиляция программ
----------------------

  2.1. Зависимости
  ----------------
    Прежде чем компилировать программы, вам нужно получить
    зависимости -- библиотечные и бинарные файлы -- отсюда:
        http://www.ireon.org/downloads.html
    Распакуйте архив в корневую директорию исходных кодов проекта.

  2.2. Сборка
  -----------
    Для сборки под Visual Studio 2005 запустите файл
    src_root/build/win32/ireon.sln и соберите солюшен.


3. Компиляция документации
--------------------------
  Документация для нашего проекта поставляется в виде xml-файлов
  (http://www.w3.org/XML/) в нотации docbook (http://docbook.org/).
  Преимущество такого подхода в том, что пользователь при надлежащем
  стремлении может преобразовать эти файлы практически в любой
  формат. Минус состоит в том, что для удобного просмотра
  документацию необходимо преобразовать из исходных файлов. Нашим
  проектом поставляется набор утилит, которые выполняют практически
  не требующее никаких усилий преобразование в форматы xhtml и pdf.
  Преобразование в другие форматы оставляется на усмотрение
  пользователя.

  Чтобы избавить пользователя от необходимости самостоятельно
  разбираться в тонкостях процесса преобразования документов мы
  подготовили набор скриптов, с помощью которых компиляция
  документации требует всего лишь ввода трех команд.


  ***** Выполнять скрипты scons необходимо из каталога src_root *****


  3.1 Установка необходимых утилит
  --------------------------------
    Полный набор утилит для компиляции документов занимает более 8
    Мб. Поэтому мы разделили его на две поставки - базовую и полную.
    Базовая поставка дает возможность рендеринга в html всех
    документов. Полная поставка добавляет к этому рендеринг в pdf.
    Если вам не нужен рендеринг в pdf, то следует выбрать базовую
    поставку.

    Скачивание и установка необходимых утилит производятся
    автоматически с помощью поставляемых скриптов.

    Для скачивания и установки базового комплекта утилит выполните

      scons install-prereqs-docbook-html
      или просто запустите build/install_docbook_prereqs_lite.bat

    Для получения полного комплекта утилит выполните

      scons install-prereqs-docbook
      или просто запустите build/install_docbook_prereqs_full.bat

    После запуска команды с нашего сайта будет скачан сначала
    перечень файлов, а потом и сами файлы (не забудьте разрешить это
    файрволлу, если он у вас есть), потом эти файлы будут
    установлены в папку src_root/build/docbook/

    Вот список того, что должно скачаться:
      * процессор xslt saxon
      * dtd docbook
      * xsl-файлы для трансформаций
      * специализированные xsl-файлы проекта ireon.org
      * комплект дополнительных изображений для xhtml

    В полном комплекте также присутствует:
      * FOP (Formatting Objects Processor)
      * набор шрифтов для fop

    Всего будет скачано порядка 1,5-2 Мб для базового комплекта и
    8 Мб для полного.

    Данную команду необходимо выполнить только один раз - для
    загрузки и установки нужных утилит. После того, как утилиты
    установлены, вы можете сразу переходить непосредственно к
    компиляции документов, минуя данную команду.

    Если во время выполнения команды сообщений об ошибках не
    выводилось, то переходите к следующем пункту.

    Обновление утилит
    -----------------
      Для обновления утилит необходимо выполнять те же команды, что
      и для скачивания и установки. Скачиваться будут только
      обновленные файлы.


  3.2 Компиляция документации
  ---------------------------
    Компиляция документации производится следующей командой:

      scons <target>

    где вместо <target> надо вставить одну или несколько из целей,
    описанных ниже. Например, так:

      scons docs-development docs-chronicles

    или просто

      scons docs

    чтобы скомпилировать всю имеющуюся документацию.


    Дерево целей:
    -------------
    + docs
    | вся документация вместе взятая
    |
    |-+ docs-development
    | | документация по процессу разработки
    | |
    | |-+ docs-development-scmp
    | | | план управления конфигурациями
    | |
    | |-+ docs-development-spmp
    | | | план управления проектом
    |
    |-+ docs-game_design
    | | документация по геймдизайну
    | |
    | |-+ docs-game_design-concept
    | | | концепт-документ проекта
    | |
    | |-+ docs-game_design-chronicles
    | | | хроники мира иреона
    | |
    | |-+ docs-game_design-srs
    | | | спецификация требований (**диздок**)
    | |
    | |-+ docs-game_design-world_guide
    | | | описание острова Новалия (локации)
    |
    |-+ docs-papers
    | | различные дополнительные документы, статьи
    | |
    | |-+ docs-papers-cvs_tutorial
    | | | краткий туториал по cvs
    | |
    | |-+ docs-papers-constructive_politics
    | | | перевод статьи Mathew Mihaly о политике в ММОРПГ


    Для каждой указанной цели можно добавить суффикс -html или -pdf
    для генерации, соответственно, только html или только pdf
    версии. Например, команда

      scons docs-development-pdf

    скомпилирует pdf версии всех документов по процессу разработки
    (обратите внимание, что для этого у вас должен быть установлен
    полный комплект утилит).

    Если все пройдет успешно, то скомпилированная документация
    должна оказаться в подкаталогах каталога
    src_root/build/output/<os>/doc, где <os> -- тип вашей
    операционной системы. Например, для Windows папка будет
    src_root/build/output/win32/doc.

    Если необходимо скомпилировать документацию для веб-сайта, то не
    забудьте о системе Orphus. Через командную строку перед target
    пишем buildForSite=1, например:

    scons buildForSite=1 docs-development-proposal-html


  3.3 Установка документации
  --------------------------
    Если вы не планируете более пересобирать документацию, то мы
    рекомендуем установить ее в то место, где она должна быть в
    дистрибутиве, то есть в папке doc корня дистрибутива. Это
    делается командой

      scons install-<target>

    где <target> -- та цель, с которой вы компилировали документацию
    в предыдущем шаге. Например, если вы компилировали документацию
    следующей командой

      scons docs-html

    то установить ее можно такой командой

      scons install-docs-html


4. Где получить помощь по сборке
--------------------------------
  Любую помощь по вопросам, касающимся проекта, в том числе и по
  сборке, вы можете получить в следующих местах:
    * на форуме проекта - http://forum.ireon.org/
    * на канале проекта в irc - #ireon, сеть rusnet
      руководство по подключению http://bugtraq.ireon.org/wiki/Tutorials/SVN
    * по почте - help-build@ireon.org


$Id: README_RU 754 2006-09-24 10:20:37Z zak $

